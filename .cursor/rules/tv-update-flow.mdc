---
description: Flujo obligatorio tras cada cambio: build, commit, push, deploy, tv:package, tv:install
globs: 
alwaysApply: true
---

# TV - Flujo de actualización para probar en la TV

**Cada vez que hagas un cambio en el código**, ejecuta **todos** estos pasos en orden:

## 1. Build
```bash
npm run build
```
Corregir errores antes de continuar.

## 2. Commit y push
```bash
git add .
git commit -m "..."
git push origin main
```

## 3. Verificar deploy (BLOQUEANTE)
```bash
vercel ls
```
**Esperar hasta que el primer deployment muestre ● Ready.** Si muestra ● Building: NO continuar. Ejecutar `vercel ls` de nuevo cada ~30s hasta ver ● Ready. Solo entonces pasar al paso 4.

## 4. Reconstruir IPK
```bash
npm run tv:package
```
Genera `com.watchily.web_1.0.0_all.ipk` en la raíz del proyecto.

## 5. Instalar en la TV (OBLIGATORIO, sin preguntar)
```bash
npm run tv:install
```
O con dispositivo: `ares-install com.watchily.web_1.0.0_all.ipk -d <nombre-tv>`

**El agente SIEMPRE ejecuta `npm run tv:install` tras `tv:package`.** NUNCA preguntar "¿quieres que instale?" — ejecutarlo automáticamente. El usuario debe poder probar en la TV sin pasos manuales.

## Obligatorio
**Prioridad: que el usuario pruebe en la TV sin contratiempos.** El agente NUNCA dice "ya puedes probar" hasta haber ejecutado TODOS los pasos y confirmado ● Ready. No ejecutar tv:package ni tv:install si el deploy sigue en ● Building — el contenido se sirve desde Vercel y el usuario vería una versión antigua. Esperar a que cada comando termine antes del siguiente.

## Resumen – ejecutar en este orden
1. `npm run build` (esperar a que termine)
2. `git add .`
3. `git commit -m "..."`
4. `git push origin main`
5. `vercel ls` (esperar hasta ● Ready)
6. `npm run tv:package`
7. `npm run tv:install`

**No dar por terminada la tarea hasta completar los 7 pasos.**
